version: '3.8'
services:
  quantumleap:
    # We try to always provide the latest stable version
    image: orchestracities/quantumleap:${QL_VERSION:-0.8.1}
    hostname: quantumleap
    depends_on:
        - mongodb
        - orion
        - cratedb
    networks:
      - fiware_backend
    ports:
      - "8668:8668"
    deploy:
      replicas: 1
    environment:
      - CRATE_HOST=${QL_CRATEDB_HOST:-cratedb-proxy}
      - LOGLEVEL=${QL_LOG_LEVEL:-ERROR}
        # - USE_GEOCODING=false
      - REDIS_HOST=${QL_REDIS_HOST:-redis-cache}
      - REDIS_PORT=${QL_REDIS_PORT:-6379}
      - CACHE_QUERIES=${QL_CACHE_QUERIES:-TRUE}
    logging:
        driver: "json-file"
        options:
            max-file: 5
            max-size: 1m
networks:
  fiware_backend:
    external: true
